## ğŸ“‹ Plano BriefFlow - MVP de GeraÃ§Ã£o de ConteÃºdo com Fontes Reais

### ğŸ¯ Escopo do MVP

**Fluxo principal:**
```
Cadastro Cliente â†’ Cadastro Fontes (blogs) â†’ Scraper DiÃ¡rio â†’ 
AnÃ¡lise Claude â†’ GeraÃ§Ã£o de Pautas â†’ VisualizaÃ§Ã£o/EdiÃ§Ã£o
```

---

### ğŸ“ Estrutura de Pastas

```
briefflow/
â”œâ”€â”€ apps/
â”‚   â”œâ”€â”€ web/                          # Next.js 14 (App Router)
â”‚   â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”‚   â”œâ”€â”€ (dashboard)/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ clientes/         # CRUD clientes
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ fontes/           # CRUD fontes por cliente
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ pautas/           # Lista e ediÃ§Ã£o de pautas
â”‚   â”‚   â”‚   â””â”€â”€ api/                  # API routes internos
â”‚   â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ lib/
â”‚   â”‚   â””â”€â”€ package.json
â”‚   â”‚
â”‚   â””â”€â”€ desktop/                      # Electron app
â”‚       â”œâ”€â”€ electron/
â”‚       â”‚   â”œâ”€â”€ main.js               # Entry point Electron
â”‚       â”‚   â””â”€â”€ preload.js            # Context bridge
â”‚       â””â”€â”€ package.json
â”‚
â”œâ”€â”€ backend/                          # FastAPI
â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”‚   â”œâ”€â”€ v1/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ endpoints/
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ clients.py    # /clients
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ sources.py    # /sources
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ contents.py   # /contents (artigos coletados)
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ briefs.py     # /briefs (pautas geradas)
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ api.py
â”‚   â”‚   â”œâ”€â”€ core/
â”‚   â”‚   â”‚   â”œâ”€â”€ config.py
â”‚   â”‚   â”‚   â””â”€â”€ database.py           # Supabase client
â”‚   â”‚   â”œâ”€â”€ models/                   # Pydantic schemas
â”‚   â”‚   â””â”€â”€ main.py
â”‚   â”œâ”€â”€ requirements.txt
â”‚   â””â”€â”€ Dockerfile
â”‚
â”œâ”€â”€ workers/                          # Scripts Python + N8N
â”‚   â”œâ”€â”€ scraper/
â”‚   â”‚   â”œâ”€â”€ spiders/
â”‚   â”‚   â”‚   â”œâ”€â”€ blog_spider.py        # Scraper genÃ©rico de blogs
â”‚   â”‚   â”‚   â””â”€â”€ parsers/
â”‚   â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â””â”€â”€ run.py                    # Entry point
â”‚   â”œâ”€â”€ analyzer/                     # MÃ³dulo Claude API
â”‚   â”‚   â”œâ”€â”€ analyzer.py               # AnÃ¡lise de conteÃºdo
â”‚   â”‚   â”œâ”€â”€ prompt_templates/         # Prompts para Claude
â”‚   â”‚   â””â”€â”€ brief_generator.py        # GeraÃ§Ã£o de pautas
â”‚   â””â”€â”€ n8n/
â”‚       â””â”€â”€ workflows/                # Export JSON dos workflows
â”‚
â””â”€â”€ packages/
    â””â”€â”€ shared-types/                 # Types compartilhados (TS/Python)
```

---

### ğŸ—„ï¸ Schema Supabase

```sql
-- Clientes (agÃªncia pode ter vÃ¡rios)
CREATE TABLE clients (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  name TEXT NOT NULL,
  description TEXT,
  niche TEXT,                        -- nicho (ex: "marketing digital")
  target_audience TEXT,              -- pÃºblico-alvo
  created_at TIMESTAMPTZ DEFAULT NOW()
);

-- Fontes (blogs/sites por cliente)
CREATE TABLE sources (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  client_id UUID REFERENCES clients(id) ON DELETE CASCADE,
  name TEXT NOT NULL,                -- "Blog Neil Patel"
  url TEXT NOT NULL,                 -- https://neilpatel.com/blog
  type TEXT DEFAULT 'blog',          -- blog, youtube, news
  is_active BOOLEAN DEFAULT true,
  last_scraped_at TIMESTAMPTZ,
  created_at TIMESTAMPTZ DEFAULT NOW()
);

-- ConteÃºdos coletados (artigos/posts)
CREATE TABLE contents (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  source_id UUID REFERENCES sources(id) ON DELETE CASCADE,
  client_id UUID REFERENCES clients(id) ON DELETE CASCADE,
  title TEXT NOT NULL,
  url TEXT NOT NULL UNIQUE,
  content_text TEXT,                 -- texto limpo do artigo
  summary TEXT,                      -- resumo gerado
  topics JSONB,                      -- ["SEO", "Marketing de ConteÃºdo"]
  published_at TIMESTAMPTZ,
  scraped_at TIMESTAMPTZ DEFAULT NOW(),
  is_analyzed BOOLEAN DEFAULT false
);

-- Pautas/Briefs gerados
CREATE TABLE briefs (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  client_id UUID REFERENCES clients(id) ON DELETE CASCADE,
  content_ids UUID[],                -- referÃªncias aos conteÃºdos usados
  title TEXT NOT NULL,               -- tÃ­tulo da pauta
  angle TEXT,                        -- Ã¢ngulo/tese central
  key_points TEXT[],                 -- pontos principais
  content_type TEXT,                 -- post, carrossel, vÃ­deo, etc
  suggested_copy TEXT,               -- copy sugerida
  status TEXT DEFAULT 'draft',       -- draft, approved, rejected
  created_at TIMESTAMPTZ DEFAULT NOW(),
  generated_by TEXT DEFAULT 'claude' -- claude, manual
);

-- ConfiguraÃ§Ãµes de anÃ¡lise por cliente
CREATE TABLE analysis_configs (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  client_id UUID REFERENCES clients(id) ON DELETE CASCADE,
  min_content_length INT DEFAULT 500,
  topics_of_interest TEXT[],         -- tÃ³picos especÃ­ficos pra focar
  exclude_patterns TEXT[],           -- padrÃµes a excluir
  created_at TIMESTAMPTZ DEFAULT NOW()
);
```

---

### ğŸ”§ Stack TÃ©cnica Detalhada

| Camada | Tecnologia | Justificativa |
|--------|-----------|---------------|
| **Frontend** | Next.js 14 + App Router | SSR, API routes, otimizado pra Electron |
| **UI** | Shadcn/UI + Tailwind | Componentes prontos, consistente |
| **Desktop** | Electron 28+ | App nativo Windows/Mac, auto-update |
| **Backend** | FastAPI | Async nativo, Pydantic, OpenAPI auto |
| **Banco** | Supabase (Postgres) | Auth, realtime, SDK fÃ¡cil |
| **Scraping** | Scrapy + Playwright | Blogs estÃ¡ticos e dinÃ¢micos (JS) |
| **IA** | Claude API (Anthropic) | Melhor anÃ¡lise de conteÃºdo longo |
| **AutomaÃ§Ã£o** | N8N | OrquestraÃ§Ã£o visual de workflows |
| **Fila** | Redis + Celery (opcional) | Jobs assÃ­ncronos pesados |

---

### ğŸ”„ Fluxo de Dados

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  N8N Workflow (Schedule: DiÃ¡rio 6h)                             â”‚
â”‚  1. Busca sources ativos no banco                               â”‚
â”‚  2. Para cada source:                                           â”‚
â”‚     â”œâ”€ Chama scraper Python (/scrape)                          â”‚
â”‚     â”œâ”€ Recebe artigos novos                                     â”‚
â”‚     â”œâ”€ Chama Claude para anÃ¡lise (/analyze)                    â”‚
â”‚     â””â”€ Salva no Supabase (contents)                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Quando X conteÃºdos novos coletados:                           â”‚
â”‚  1. Agrupa por tema/similaridade                               â”‚
â”‚  2. Chama Claude para gerar pautas (/generate-briefs)          â”‚
â”‚  3. Salva briefs no banco                                      â”‚
â”‚  4. Notifica desktop app (Electron IPC)                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### ğŸ“… Roadmap de ImplementaÃ§Ã£o (6-8 semanas)

#### **Fase 1: FundaÃ§Ã£o (Semanas 1-2)**
- [ ] Setup monorepo (Turborepo ou simples)
- [ ] Configurar Supabase (projeto + tabelas)
- [ ] Criar API FastAPI bÃ¡sica (health check, auth)
- [ ] Setup Next.js + Shadcn/UI
- [ ] Conectar frontend com Supabase auth

#### **Fase 2: Core de Dados (Semanas 2-3)**
- [ ] CRUD Clientes (UI + API)
- [ ] CRUD Fontes por cliente
- [ ] Scraper Python bÃ¡sico (1 blog de teste)
- [ ] Salvar conteÃºdos no banco
- [ ] Testar fluxo: cadastrar fonte â†’ scraper â†’ banco

#### **Fase 3: InteligÃªncia (Semanas 3-5)**
- [ ] Integrar Claude API
- [ ] Criar prompts de anÃ¡lise de conteÃºdo
- [ ] Gerador de pautas (primeira versÃ£o)
- [ ] Salvar briefs no banco
- [ ] Interface de visualizaÃ§Ã£o de pautas

#### **Fase 4: AutomaÃ§Ã£o (Semana 5-6)**
- [ ] Criar workflow N8N (coleta diÃ¡ria)
- [ ] Conectar N8N com scraper Python (HTTP)
- [ ] Conectar N8N com Claude (HTTP)
- [ ] Testar fluxo completo end-to-end
- [ ] Ajustar prompts baseado em resultados

#### **Fase 5: Desktop (Semanas 6-7)**
- [ ] Configurar Electron
- [ ] Empacotar Next.js no Electron
- [ ] Sistema de notificaÃ§Ãµes desktop
- [ ] Auto-update configurado
- [ ] Build para Windows (primeiro)

#### **Fase 6: Polish (Semana 7-8)**
- [ ] Testes com dados reais (blogs de marketing)
- [ ] Refinar prompts de geraÃ§Ã£o
- [ ] UI/UX polimento
- [ ] DocumentaÃ§Ã£o bÃ¡sica
- [ ] Deploy interno na agÃªncia

---

### ğŸš€ PrÃ³ximos Passos Imediatos

1. **Criar estrutura de pastas** do projeto
2. **Inicializar Next.js** com Shadcn/UI
3. **Setup Supabase** (projeto + schema)
4. **Criar FastAPI** bÃ¡sico

**Quer que eu comece implementando a Fase 1?** Posso criar toda a estrutura inicial (monorepo, Next.js, FastAPI, Supabase schema) em alguns minutos.

Ou prefere ajustar algo no plano primeiro?